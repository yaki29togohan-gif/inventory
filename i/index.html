<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç‰©å“ç®¡ç†</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",sans-serif;margin:16px;line-height:1.4}
    .card{border:1px solid #ddd;border-radius:14px;padding:16px;max-width:520px;margin:auto}
    .title{font-size:18px;font-weight:700;margin-bottom:8px}
    .itemid{font-size:28px;font-weight:800;margin:8px 0}
    .btn{display:block;width:100%;padding:14px;border-radius:12px;border:0;font-size:16px;font-weight:700;margin-top:10px}
    .primary{background:#111;color:#fff}
    .secondary{background:#eee;color:#111}
    .hint{color:#555;font-size:13px;margin-top:10px}
    .toast{color:#0a7; font-size:13px; margin-top:8px; display:none}
    .row{display:flex; gap:10px}
    .row a{flex:1; text-decoration:none}
  </style>
</head>

<body>
  <div class="card">
    <div class="title">èª²å†… ç‰©å“ç®¡ç†</div>

    <div id="itemName" style="color:#444;">ï¼ˆç‰©å“åã¯ä»»æ„ï¼‰</div>
    <div class="itemid" id="itemId">UNKNOWN</div>

    <!-- ä¾¿åˆ©æ©Ÿèƒ½ï¼ˆä»»æ„ï¼‰ï¼šã‚³ãƒ”ãƒ¼ -->
    <button class="btn secondary" id="copyBtn">ğŸ“‹ ç‰©å“IDã‚’ã‚³ãƒ”ãƒ¼</button>
    <div class="toast" id="toast">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ</div>

    <!-- Aæ¡ˆï¼šSlack Link Trigger ã‚’å©ããƒœã‚¿ãƒ³ï¼ˆè²¸å‡º / è¿”å´ï¼‰ -->
    <div class="row">
      <a id="checkoutLink" href="#">
        <button class="btn primary">âœ… è²¸ã—å‡ºã™ï¼ˆSlackãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãï¼‰</button>
      </a>
      <a id="checkinLink" href="#">
        <button class="btn secondary">ğŸ“¦ è¿”å´ã‚’å—ã‘å–ã‚‹ï¼ˆSlackãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãï¼‰</button>
      </a>
    </div>

    <div class="hint">
      â€»ä¸Šã®ãƒœã‚¿ãƒ³ã§Slackã®å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ãŒç›´æ¥é–‹ãã¾ã™ï¼ˆç‰©å“IDã¯è‡ªå‹•ã§æ¸¡ã—ã¾ã™ï¼‰ã€‚<br/>
      é–‹ã‹ãªã„å ´åˆï¼šSlackã‚¢ãƒ—ãƒªã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚
    </div>

    <!-- ä¿é™ºï¼šç‰©å“ç®¡ç†ãƒãƒ£ãƒ³ãƒãƒ«ã‚’é–‹ããƒªãƒ³ã‚¯ï¼ˆä»»æ„ï¼‰ -->
    <div class="hint" style="margin-top:8px;">
      <a id="slackChannelWeb" href="#" target="_blank" rel="noopener">ç‰©å“ç®¡ç†ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã</a>
    </div>
  </div>

<script>
  // ========= è¨­å®šï¼šSlack Link Trigger IDï¼ˆSlackã§ç™ºè¡Œã•ã‚Œã‚‹ï¼‰ =========
  // ä¾‹ï¼šSlackã®ç®¡ç†ç”»é¢/ã‚¢ãƒ—ãƒªè¨­å®šã§ Link Trigger ã‚’ä½œã‚‹ã¨ã€trigger_id ãŒæ‰•ã„å‡ºã•ã‚Œã¾ã™
  const CHECKOUT_TRIGGER_ID = "<CHECKOUT_TRIGGER_ID>"; // è²¸å‡ºç”¨
  const CHECKIN_TRIGGER_ID  = "<CHECKIN_TRIGGER_ID>";  // è¿”å´ç”¨

  // ï¼ˆä»»æ„ï¼‰ç‰©å“ç®¡ç†ãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãä¿é™ºï¼‰
  const TEAM_ID = "T01234567";
  const CHANNEL_ID = "C089ABCDE";

  // ========= 1) QRã®URLã‹ã‚‰ item ã‚’èª­ã‚€ï¼ˆGitHub Pageså‘ã‘ï¼‰ =========
  // ä¾‹ï¼šhttps://.../inventory/i/?item=SET-003
  const params = new URLSearchParams(location.search);
  const itemId = params.get("item") || "UNKNOWN";
  document.getElementById("itemId").textContent = itemId;

  // ========= 2) Link Trigger URL ã‚’çµ„ã¿ç«‹ã¦ã¦ãƒœã‚¿ãƒ³ã«è¨­å®š =========
  // Slack Link Trigger ã¯ slack.com ã®URLï¼ˆshortcutsï¼‰ã¨ã—ã¦èµ·å‹•ã—ã¾ã™
  // item=SET-003 ã‚’ãã®ã¾ã¾æ¸¡ã™ï¼ˆSlackå´ã§å—ã‘å–ã£ã¦ãƒ¢ãƒ¼ãƒ€ãƒ«åˆæœŸå€¤ã«ä½¿ã†ï¼‰
  const checkoutUrl = `https://slack.com/shortcuts/${encodeURIComponent(CHECKOUT_TRIGGER_ID)}?item=${encodeURIComponent(itemId)}`;
  const checkinUrl  = `https://slack.com/shortcuts/${encodeURIComponent(CHECKIN_TRIGGER_ID)}?item=${encodeURIComponent(itemId)}`;

  document.getElementById("checkoutLink").href = checkoutUrl;
  document.getElementById("checkinLink").href  = checkinUrl;

  // ========= 3) ï¼ˆä»»æ„ï¼‰ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ããƒªãƒ³ã‚¯ =========
  const slackChannelWeb = `https://app.slack.com/client/${TEAM_ID}/${CHANNEL_ID}`;
  document.getElementById("slackChannelWeb").href = slackChannelWeb;

  // ========= 4) ï¼ˆä»»æ„ï¼‰ç‰©å“IDã‚³ãƒ”ãƒ¼ =========
  const toast = document.getElementById("toast");
  document.getElementById("copyBtn").addEventListener("click", async () => {
    try{
      await navigator.clipboard.writeText(itemId);
      toast.style.display = "block";
      setTimeout(()=> toast.style.display = "none", 1200);
    }catch(e){
      alert("ã‚³ãƒ”ãƒ¼ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ç‰©å“IDã‚’é•·æŠ¼ã—ã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
    }
  });
</script>
</body>
</html>
